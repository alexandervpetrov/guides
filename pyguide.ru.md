
# Python Development Guide

*Здесь описаны и документированы рекомендации и соглашения по программированию на Python.
За исключением отдельных примеров тут нет слишком специфичной информации - это общие
рекомендации и философия разработки. Есть надежда что документирование таких вещей
поможет команде быть более сбалансированной и поможет эффективнее поддерживать в коде
ряд ценностей важных для эволюции проекта.*


Самыми базовыми вещами в плане стиля и вкуса для любого программиста на Python
являются [The Zen of Python (PEP 20)][pep20] и [Style Guide for Python Code (PEP 8)][pep8] -
они обязательны к прочтению. Абсолютно весь Python-код на проекте **должен** проходить
проверку на соответствие PEP 8 стандартной утилитой [pycodestyle][pycodestyle]
в режиме проверки всех ошибок за исключением ограничения на длину строки (`--ignore=E501`).

Основой для соглашений по стилю кодирования является [Google Python Style Guide][googlepyguide],
его необходимо прочитать, если в данной статье прямо что-то не оговорено,
то значит по умолчанию берётся соглашение из этого руководства Гугла.

Также грамотные и разумные вещи можно почитать в [The Hitchhiker’s Guide to Python][hitchhiker].

[pep20]: https://www.python.org/dev/peps/pep-0020/
[pep8]: https://www.python.org/dev/peps/pep-0008/
[pycodestyle]: https://pypi.org/project/pycodestyle/
[googlepyguide]: https://github.com/google/styleguide/blob/gh-pages/pyguide.md
[hitchhiker]: https://docs.python-guide.org/


## 1. Ясность и простота

Главным приоритетом при написании кода всегда должно быть сочетание красоты, ясности,
читабельности и простоты. Код пишется **в первую очередь для людей** которые его будут
читать и поддерживать, и лишь во вторую очередь для выполнения задачи.
**Недопустимо** коммитить неясный или трудно поддерживаемый код, аргументируя "он же работает"
или "мне понятно". Если код плохо понимает коллега при ревью - это серьёзное основание
для того, чтобы уделить дополнительное время и переделать.

**Наименования**. Очень важно выбирать удачные названия для переменных, функций, модулей.
Обращайте внимание на форму слова, например для обработчиков событий разумно использовать
[past participle][participle] (clicked, saved, moved, ...), для действий - инфинитив (click, save, move, ...),
для функций возвращающих булевские значений часто удобен префикс is_.
Какую бы схему наименований вы не выбрали будьте последовательны! Недопустимо в рамках
одного модуля перемешивать разные стили или схемы наименований. Если удачное слово
не приходит в голову, то удобно пробовать [подбирать синонимы][thesaurus]. Названия переменных
должны соответствовать области использования и видимости. К примеру, если переменная
используется только в scope цикла длиной несколько строк, то вполне допустимо назвать
её в одну или несколько букв, но чем шире область использования - тем более содержательнее
и осмысленнее должно быть название.

*Придумывание кода* - это большей частью управление сложностью и управление зависимостями.
Автор кода всегда должен стремится минимизировать сложность кода и сделать минимальной
его зависимость от других частей системы, либо сделать зависимости явными и хорошо
структурированными. Очень часто эти цели конкурируют с друг другом - бывает, что уменьшить
сложность кода можно только ценой введения дополнительной зависомости (вызов вспомогательной
функции или использование модуля/библиотеки), и наоборот - иногда убрать зависимость можно
только ценой повышения сложности кода (написав свою реализацию чего-то, вводя дополнительные
слои - например добавляя обработчики ошибок). Большей частью искусство написания хорошего кода,
опыт программиста и состоят в подборе удачного баланса между этими двумя вещами.

**Сложность**. Функции полезно оценивать как просто по длине кода - количеству значащих строк,
так и прикидывать [цикломатическую сложность][cyclomatic] - её можно понимать либо как разность между
количеством ветвлений (`if`-ов) и количеством точек выхода (`return`-ов), либо как количество
тестов необходимое для полного покрытия кода. Нужно стремиться разбивать свой код
на функции лаконичные - до 40-60 строк, и простые - цикломатическая сложность не более 10-15.

**Зависимости**. Python довольно выразительный язык с богатыми возможностями стандартной библиотеки.
Если можно что-то лаконично и ясно реализовать без использования вспомогательных функций
из других модулей, то нужно стараться так и делать. Дублирование коротеньких кусочков кода -
это не всегда зло! Далеко не всегда нужно выделять повторяющийся кусок в отдельную
библиотечную функцию - нужно думать о том, что это создаёт зависимость. Выделять
в функции-утилиты разумно только те кусочки работы, которые потенциально нужно будет
переопределить, изменить поведение. Граф/карта зависомостей должна иметь слоистую/древовидную
структуру, а не "спагетти". Циклические зависимости следует рассматривать как временные
костыли и следствие плохой архитектуры и если уж нельзя их избежать в данный момент,
то всегда ставить рядом поясняющий комментарий под тегом `TODO` или `FIXME`.


[participle]: https://en.wikipedia.org/wiki/Participle#Modern_English
[thesaurus]: https://www.thesaurus.com/
[cyclomatic]: https://en.wikipedia.org/wiki/Cyclomatic_complexity
